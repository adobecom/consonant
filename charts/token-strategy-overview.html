<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Design Token Strategy Overview</title>

    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
    <script src="https://cdn.jsdelivr.net/npm/dagre@0.8.5/dist/dagre.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dagre-d3@0.6.4/dist/dagre-d3.min.js"></script>

    <style>
      :root {
        --bg: #0b0d12;
        --panel: #0f1420;
        --muted: #9aa4b2;
        --text: #e5e7eb;
        --stroke: #2b3445;
        --accent: #60a5fa;
        --good: #34d399;
        --warn: #fbbf24;
        --gold: #fbbf24;
        --green: #34d399;
        --blue: #3b82f6;
      }
      html,
      body {
        height: 100vh;
        width: 100vw;
        margin: 0;
        padding: 0;
        overflow: hidden;
        max-width: none;
        box-sizing: border-box;
        background: var(--bg);
        color: var(--text);
        font-family:
          ui-sans-serif,
          system-ui,
          -apple-system,
          Segoe UI,
          Roboto,
          Helvetica,
          Arial;
      }
      * {
        box-sizing: border-box;
      }

      .wrap {
        width: 100vw;
        height: 100vh;
        max-width: none;
        display: grid;
        grid-template-columns: 1.35fr 0.65fr;
        gap: 16px;
        padding: 16px;
        box-sizing: border-box;
        margin: 0;
      }
      .wrap.right-collapsed {
        grid-template-columns: 1fr;
        padding: 0;
        gap: 0;
        width: 100vw;
        max-width: none;
      }
      .left {
        background: linear-gradient(
          180deg,
          rgba(255, 255, 255, 0.04),
          rgba(255, 255, 255, 0.02)
        );
        border: 1px solid var(--stroke);
        border-radius: 14px;
        overflow: hidden;
        position: relative;
        width: 100%;
        height: 100%;
        max-width: none;
        min-width: 0;
      }
      .wrap.right-collapsed .left {
        border-radius: 0;
        border-left: none;
        border-right: none;
        border-top: none;
        width: 100vw;
      }
      .toolbar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px 14px;
        border-bottom: 1px solid var(--stroke);
        background: rgba(255, 255, 255, 0.02);
        gap: 12px;
        flex-wrap: wrap;
      }
      .title {
        display: flex;
        flex-direction: column;
        gap: 4px;
        min-width: 320px;
      }
      .title h1 {
        font-size: 14px;
        margin: 0;
        letter-spacing: 0.2px;
      }
      .title p {
        font-size: 12px;
        margin: 0;
        color: var(--muted);
      }
      .btns {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        margin-left: auto;
      }
      button {
        appearance: none;
        border: 1px solid var(--stroke);
        background: rgba(255, 255, 255, 0.02);
        color: var(--text);
        padding: 8px 10px;
        border-radius: 10px;
        font-size: 12px;
        cursor: pointer;
      }
      button:hover {
        border-color: rgba(96, 165, 250, 0.8);
      }
      .svgWrap {
        position: absolute;
        inset: 58px 0 0 0;
        overflow: auto;
        width: 100%;
        height: 100%;
      }

      .right {
        background: var(--panel);
        border: 1px solid var(--stroke);
        border-radius: 14px;
        overflow: hidden;
        display: flex;
        flex-direction: column;
      }
      .rightHeader {
        padding: 12px 14px;
        border-bottom: 1px solid var(--stroke);
        background: rgba(255, 255, 255, 0.02);
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
      }
      .rightHeaderContent {
        flex: 1;
      }
      .toggleBtn {
        appearance: none;
        border: 1px solid var(--stroke);
        background: rgba(255, 255, 255, 0.02);
        color: var(--text);
        padding: 6px 10px;
        border-radius: 8px;
        font-size: 12px;
        cursor: pointer;
        flex-shrink: 0;
      }
      .toggleBtn:hover {
        border-color: rgba(96, 165, 250, 0.8);
      }
      .right.collapsed {
        display: none;
      }
      .rightHeader h2 {
        margin: 0;
        font-size: 14px;
      }
      .rightHeader p {
        margin: 6px 0 0;
        font-size: 12px;
        color: var(--muted);
      }
      .card {
        padding: 14px;
        overflow: auto;
      }
      .card h3 {
        margin: 0 0 6px;
        font-size: 16px;
      }

      .pillRow {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        margin: 8px 0 12px;
      }
      .pill {
        font-size: 11px;
        padding: 4px 8px;
        border-radius: 999px;
        border: 1px solid var(--stroke);
        color: var(--muted);
        background: rgba(255, 255, 255, 0.02);
      }
      .pill.accent {
        border-color: rgba(96, 165, 250, 0.6);
        color: rgba(96, 165, 250, 0.95);
      }
      .pill.good {
        border-color: rgba(52, 211, 153, 0.6);
        color: rgba(52, 211, 153, 0.95);
      }
      .pill.warn {
        border-color: rgba(251, 191, 36, 0.6);
        color: rgba(251, 191, 36, 0.95);
      }
      .pill.gold {
        border-color: rgba(251, 191, 36, 0.6);
        color: rgba(251, 191, 36, 0.95);
      }

      .section {
        margin-top: 14px;
        padding-top: 12px;
        border-top: 1px dashed rgba(255, 255, 255, 0.12);
      }
      .section h4 {
        margin: 0 0 8px;
        font-size: 12px;
        color: var(--muted);
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }
      ul {
        margin: 0 0 0 18px;
        padding: 0;
        line-height: 1.5;
        font-size: 13px;
        color: var(--text);
      }
      li {
        margin: 6px 0;
      }

      svg {
        width: 100%;
        height: 100%;
      }
      .node rect {
        rx: 12px;
        ry: 12px;
        fill: rgba(255, 255, 255, 0.03);
        stroke: rgba(255, 255, 255, 0.16);
        stroke-width: 1.3px;
      }
      .node.selected rect {
        stroke: rgba(96, 165, 250, 0.95);
        stroke-width: 2.4px;
      }
      .node text {
        fill: var(--text);
        font-weight: 650;
        font-size: 12px;
      }

      .edgePath path {
        stroke: rgba(255, 255, 255, 0.22);
        stroke-width: 1.4px;
        fill: none;
      }
      .edgeLabel text {
        fill: rgba(255, 255, 255, 0.6);
        font-size: 10px;
      }

      .dashed path {
        stroke-dasharray: 6 5;
        opacity: 0.95;
      }
      .strong path {
        stroke: rgba(96, 165, 250, 0.55);
        stroke-width: 2px;
      }
      .success path {
        stroke: rgba(52, 211, 153, 0.55);
        stroke-width: 2px;
      }
      .tier path {
        stroke: rgba(251, 191, 36, 0.55);
        stroke-width: 2px;
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <div class="left">
        <div class="toolbar">
          <div class="title">
            <h1>Design Token Strategy Overview</h1>
            <p>
              Three-tier token system, taxonomy, and how tokens power atomic
              design components.
            </p>
          </div>
          <div class="btns">
            <button id="btnCenter">Center view</button>
            <button id="btnReset">Reset selection</button>
            <button id="togglePanel" class="toggleBtn" title="Toggle panel">
              Panel
            </button>
          </div>
        </div>
        <div class="svgWrap">
          <svg id="svg"><g id="g"></g></svg>
        </div>
      </div>

      <div class="right" id="rightPanel">
        <div class="rightHeader">
          <div class="rightHeaderContent">
            <h2 id="panelTitle">Details</h2>
            <p id="panelSubtitle">Select a node in the diagram.</p>
          </div>
        </div>
        <div class="card" id="panel"></div>
      </div>
    </div>

    <script>
      const nodes = {
        raw: {
          title: "Raw Values",
          pills: ["Unabstracted", "Direct values", "Source"],
          owns: [
            "Direct color values: #FF3A30, #0D5BD9, hsla(0, 0, 46, 100%)",
            "Direct size values: 6px, 16px, 64px",
            "Direct spacing: 16px/1rem",
            "Unprocessed design values from design tools",
          ],
          leverages: [
            "Design tool outputs (Figma, Sketch, etc.)",
            "Raw CSS values",
            "Direct measurements",
          ],
          outputs: ["Raw design values", "Unprocessed tokens"],
        },

        primitives: {
          title: "Primitives",
          pills: ["Foundation", "Abstracted", "Reusable"],
          owns: [
            "Abstract raw values into named primitives",
            "Color primitives: _palette.gray.0, _palette.gray.100",
            "Size primitives: _size.6, _size.16, _size.64",
            "Typography primitives: font families, sizes, weights",
            "Spacing primitives: _space.4, _space.8, _space.16",
            "Foundation layer of the token system",
          ],
          leverages: [
            "Token naming conventions",
            "Design system taxonomy",
            "Primitive token collections",
          ],
          outputs: ["Primitive token library", "Foundation tokens for aliases"],
        },

        alias: {
          title: "Semantic Aliases",
          pills: ["Meaning-based", "Context-aware", "Semantic"],
          owns: [
            "Create semantic meaning from primitives",
            "Color aliases: palette.primary.600, palette.content.on-brand",
            "Shape aliases: shape.default, shape.rounded, shape.square",
            "Spacing aliases: space.sm, space.md, space.lg",
            "Theme-aware tokens (light/dark modes)",
            "Human-readable, meaning-based names",
          ],
          leverages: [
            "Primitive tokens as references",
            "Design system semantics",
            "Theme/mode system",
          ],
          outputs: [
            "Semantic token library",
            "Context-aware tokens",
            "Theme-specific tokens",
          ],
        },

        component: {
          title: "Component Tokens",
          pills: ["Component-specific", "Composed", "Production-ready"],
          owns: [
            "Component-specific token bindings",
            "Example: button.background.primary.solid-default",
            "Component property tokens: border, background, content",
            "Component variant tokens: primary, secondary, solid, outline",
            "Component state tokens: default, hover, active, disabled",
            "Final layer that components consume",
          ],
          leverages: [
            "Semantic alias tokens",
            "Component anatomy and structure",
            "Component variant system",
          ],
          outputs: [
            "Component token library",
            "Production-ready component tokens",
            "Component styling contracts",
          ],
        },

        taxonomy: {
          title: "Token Taxonomy & Naming",
          pills: ["Structure", "Conventions", "Organization"],
          owns: [
            "Define token naming structure: Namespace.Object.Base.Modifier",
            "Namespace: System identifier (e.g., s2a, esds)",
            "Object: Component, domain, or grouping",
            "Base: Category (color, space, typography), concept, property",
            "Modifier: Variant, state, scale, mode",
            "Organize tokens into collections (Primitives, Semantic, Component)",
          ],
          leverages: [
            "Industry naming conventions (Nathan Curtis, Design Tokens W3C)",
            "Hierarchical naming patterns",
            "Collection-based organization",
          ],
          outputs: [
            "Token naming schema",
            "Organized token structure",
            "Consistent token names",
          ],
        },

        atoms: {
          title: "Atoms",
          pills: ["Basic elements", "Smallest units", "Token-powered"],
          owns: [
            "Basic UI elements: Checkbox, Label, Icon, Link",
            "Built using component tokens",
            "Smallest reusable components",
            "Foundation for larger components",
          ],
          leverages: [
            "Component tokens for styling",
            "Primitive and semantic tokens",
            "Design system patterns",
          ],
          outputs: ["Atomic components", "Basic UI elements"],
        },

        molecules: {
          title: "Molecules",
          pills: ["Composed", "Functional groups", "Reusable"],
          owns: [
            "Composed from atoms: Button, Input, Link groups",
            "Simple functional combinations",
            "Reusable component groups",
            "Still relatively simple",
          ],
          leverages: [
            "Atomic components",
            "Component tokens",
            "Design patterns",
          ],
          outputs: ["Molecular components", "Functional component groups"],
        },

        organisms: {
          title: "Organisms",
          pills: ["Complex", "Sections", "Feature-level"],
          owns: [
            "Complex components: Table, Navigation, Card, Form Field Groups",
            "Composed from molecules and atoms",
            "Feature-level components",
            "Complete UI sections",
          ],
          leverages: [
            "Molecular and atomic components",
            "Component token system",
            "Design system architecture",
          ],
          outputs: ["Organism components", "Complex UI sections"],
        },

        templates: {
          title: "Templates",
          pills: ["Layout", "Structure", "Page-level"],
          owns: [
            "Page layouts and structures",
            "Composed from organisms",
            "Content-agnostic layouts",
            "Wireframe-level compositions",
          ],
          leverages: [
            "Organism components",
            "Layout tokens and spacing",
            "Grid and layout systems",
          ],
          outputs: ["Page templates", "Layout structures"],
        },

        pages: {
          title: "Pages",
          pills: ["Final", "Content-filled", "Production"],
          owns: [
            "Final, content-filled pages",
            "Specific instances of templates",
            "Production-ready pages",
            "Real content and data",
          ],
          leverages: [
            "Templates with real content",
            "All component layers",
            "Complete token system",
          ],
          outputs: ["Production pages", "Final user interfaces"],
        },
      };

      const edges = [
        // Three-tier system flow
        {
          from: "raw",
          to: "primitives",
          label: "abstract to",
          cls: "tier",
        },
        {
          from: "primitives",
          to: "alias",
          label: "create semantic",
          cls: "tier",
        },
        {
          from: "alias",
          to: "component",
          label: "bind to components",
          cls: "tier",
        },
        // Taxonomy influences
        {
          from: "taxonomy",
          to: "primitives",
          label: "defines structure",
          cls: "dashed",
        },
        {
          from: "taxonomy",
          to: "alias",
          label: "defines structure",
          cls: "dashed",
        },
        {
          from: "taxonomy",
          to: "component",
          label: "defines structure",
          cls: "dashed",
        },
        // Atomic design flow
        {
          from: "component",
          to: "atoms",
          label: "powers",
          cls: "strong",
        },
        {
          from: "atoms",
          to: "molecules",
          label: "compose into",
          cls: "success",
        },
        {
          from: "molecules",
          to: "organisms",
          label: "compose into",
          cls: "success",
        },
        {
          from: "organisms",
          to: "templates",
          label: "compose into",
          cls: "success",
        },
        {
          from: "templates",
          to: "pages",
          label: "become",
          cls: "success",
        },
      ];

      const g = new dagreD3.graphlib.Graph({ multigraph: true })
        .setGraph({
          rankdir: "LR",
          nodesep: 45,
          ranksep: 70,
          marginx: 24,
          marginy: 22,
        })
        .setDefaultEdgeLabel(() => ({}));

      Object.entries(nodes).forEach(([key, r]) => {
        const base =
          "fill: rgba(255,255,255,0.03); stroke: rgba(255,255,255,0.16); stroke-width: 1.3px;";
        let style = base;
        // Color code by tier/system
        if (key === "raw") {
          style =
            base +
            " stroke: rgba(255,255,255,0.4); stroke-width: 1.5px; fill: rgba(255,255,255,0.05);";
        } else if (key === "primitives") {
          style =
            base +
            " stroke: rgba(251,191,36,0.7); stroke-width: 2px; fill: rgba(251,191,36,0.1);";
        } else if (key === "alias") {
          style =
            base +
            " stroke: rgba(52,211,153,0.7); stroke-width: 2px; fill: rgba(52,211,153,0.1);";
        } else if (key === "component") {
          style =
            base +
            " stroke: rgba(59,130,246,0.7); stroke-width: 2px; fill: rgba(59,130,246,0.1);";
        } else if (key === "taxonomy") {
          style =
            base +
            " stroke: rgba(96,165,250,0.9); stroke-width: 2.5px; fill: rgba(96,165,250,0.12);";
        } else if (
          ["atoms", "molecules", "organisms", "templates", "pages"].includes(
            key,
          )
        ) {
          style =
            base +
            " stroke: rgba(167,139,250,0.6); stroke-width: 1.8px; fill: rgba(167,139,250,0.08);";
        }
        g.setNode(key, { label: r.title, rx: 12, ry: 12, padding: 14, style });
      });

      edges.forEach((e, i) => {
        g.setEdge(
          e.from,
          e.to,
          {
            label: e.label,
            class: e.cls || "",
            arrowhead: "vee",
            lineInterpolate: "basis",
          },
          `e${i}`,
        );
      });

      const svg = d3.select("#svg");
      const inner = d3.select("#g");
      const render = new dagreD3.render();

      const zoom = d3
        .zoom()
        .scaleExtent([0.5, 1.4])
        .on("zoom", (event) => inner.attr("transform", event.transform));
      svg.call(zoom);

      render(inner, g);

      function centerView() {
        const graphWidth = g.graph().width;
        const graphHeight = g.graph().height;
        const svgWidth = svg.node().clientWidth;
        const svgHeight = svg.node().clientHeight;
        const scale = 0.75;
        const tx = Math.max(16, (svgWidth - graphWidth * scale) / 2);
        const ty = Math.max(30, (svgHeight - graphHeight * scale) / 2);
        svg
          .transition()
          .duration(350)
          .call(zoom.transform, d3.zoomIdentity.translate(tx, ty).scale(scale));
      }
      centerView();

      const panel = d3.select("#panel");
      const panelTitle = d3.select("#panelTitle");
      const panelSubtitle = d3.select("#panelSubtitle");

      function setPanel(key) {
        const r = nodes[key];
        if (!r) return;
        panelTitle.text(r.title);
        panelSubtitle.text(
          "Details about this part of the design token strategy.",
        );
        panel.html("");
        panel.append("h3").text(r.title);

        const pills = panel.append("div").attr("class", "pillRow");
        (r.pills || []).forEach((p, idx) => {
          const cls =
            idx === 0 ? "pill accent" : idx === 1 ? "pill good" : "pill warn";
          pills.append("span").attr("class", cls).text(p);
        });

        const s1 = panel.append("div").attr("class", "section");
        s1.append("h4").text("Owns / Responsibilities");
        const ul1 = s1.append("ul");
        (r.owns || []).forEach((x) => ul1.append("li").text(x));

        const s2 = panel.append("div").attr("class", "section");
        s2.append("h4").text("Leverages / Tools");
        const ul2 = s2.append("ul");
        (r.leverages || []).forEach((x) => ul2.append("li").text(x));

        const s3 = panel.append("div").attr("class", "section");
        s3.append("h4").text("Outputs / Artifacts");
        const ul3 = s3.append("ul");
        (r.outputs || []).forEach((x) => ul3.append("li").text(x));
      }

      function clearSelection() {
        inner.selectAll("g.node").classed("selected", false);
      }

      inner
        .selectAll("g.node")
        .style("cursor", "pointer")
        .on("click", function (event, key) {
          clearSelection();
          d3.select(this).classed("selected", true);
          setPanel(key);
        });

      inner
        .selectAll("g.node")
        .filter((d) => d === "taxonomy")
        .classed("selected", true);
      setPanel("taxonomy");

      d3.select("#btnCenter").on("click", centerView);
      d3.select("#btnReset").on("click", () => {
        clearSelection();
        inner
          .selectAll("g.node")
          .filter((d) => d === "taxonomy")
          .classed("selected", true);
        setPanel("taxonomy");
        centerView();
      });

      // Panel toggle
      const rightPanel = d3.select("#rightPanel");
      const wrap = d3.select(".wrap");
      const toggleBtn = d3.select("#togglePanel");

      function updateToggleButton() {
        const isCollapsed = rightPanel.classed("collapsed");
        toggleBtn.text(isCollapsed ? "Show Panel" : "Hide Panel");
        toggleBtn.attr("title", isCollapsed ? "Show panel" : "Hide panel");
      }

      toggleBtn.on("click", () => {
        const isCollapsed = rightPanel.classed("collapsed");
        rightPanel.classed("collapsed", !isCollapsed);
        wrap.classed("right-collapsed", !isCollapsed);
        updateToggleButton();
      });

      // Initialize button text
      updateToggleButton();
    </script>
  </body>
</html>
